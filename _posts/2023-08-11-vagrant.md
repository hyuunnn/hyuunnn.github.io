---
layout: post
title: "vagrant"
description: ""
date: 2023-08-11
tags: []
---

Vagrant는 가상 환경 생성 및 구축을 자동화 해주는 도구입니다. 

aws나 gcp와 같은 클라우드 서비스를 사용하지 않고 쿠버네티스 환경을 구축한다고 했을 때 여러 대의 장비를 네트워크로 연결하는 등 복잡한 작업을 수행해야 합니다. 

테스트를 하기 위해 가상 환경을 구축할 때도 역시 똑같은 작업을 수행해야 하는데, 이때 Vagrant를 사용하면 `Vagrantfile` 에 의해 환경 구축 및 각종 세팅을 자동으로 해줍니다. (`Vagrantfile`을 수정하여 cpu, ram, IP 설정 등 다양한 값을 변경할 수 있습니다.)

 `Vagrantfile`은 제가 이미 만들어둔 repo를 사용하시면 됩니다! 좀 더 상세한 설명은 `README.md`를 참고하시면 되겠습니다. (사실 상세하진 않습니다..)

pwnable을 할 때도 자주 사용하는 도구들이 있는데 자동으로 세팅해주면 편하겠다는 생각이 들어서 pwnable 전용 `Vagrantfile`도 만들었습니다. - <a href="https://youtu.be/X6t5dqlWngI?t=1225">defcon livectf</a>에서 Vagrant를 사용하시는 분도 있네요.

<a href="https://github.com/hyuunnn/vagrant-pwn">vagrant-pwn</a> - pwnable 환경을 자동으로 구축 (pwntools, pwndbg, seccomp-tools 등 - <a href="https://github.com/hyuunnn/vagrant-pwn/blob/main/linux/install_pkg.sh">install_pkg.sh</a> 참고)

<a href="https://github.com/hyuunnn/vagrant-k3s">vagrant-k3s</a> - 쿠버네티스의 경량화 버전인 k3s 환경으로 구축 (마스터 노드 1개, 워커 노드 3개)

pwnable 환경을 docker로 세팅하시는 분들도 많은데 취향대로 하시면 될 것 같습니다.

추후에 Windows 가상 환경 + 리버싱, 포렌식에서 사용되는 도구들을 자동으로 설치해주는 `Vagrantfile` 및 스크립트도 만들 예정입니다.

## 설치 및 사용 방법

1. <a href="https://www.virtualbox.org/">Virtualbox</a>를 설치합니다.
2. <a href="https://developer.hashicorp.com/vagrant/downloads?product_intent=vagrant">Vagrant</a>를 설치합니다.
3. `Vagrantfile`을 포함한 스크립트 파일들을 다운로드 받습니다. (아래 사진은 <a href="https://github.com/hyuunnn/vagrant-pwn">vagrant-pwn</a>을 사용했습니다.)  
4. 터미널에서 `Vagrantfile`이 있는 경로에 들어간 후 `vagrant up --provider virtualbox`를 입력합니다. (다음부터는 `vagrant up`으로 On 가능)
5. `vagrant ssh` 또는 `ssh vagrant@localhost -p31337` 또는 `ssh vagrant@10.10.10.10`을 입력하면 끝입니다. (password: vagrant)

<img src="https://raw.githubusercontent.com/hyuunnn/hyuunnn.github.io/master/assets/images/vagrant/1.png">

<img src="https://raw.githubusercontent.com/hyuunnn/hyuunnn.github.io/master/assets/images/vagrant/2.png">

<img src="https://raw.githubusercontent.com/hyuunnn/hyuunnn.github.io/master/assets/images/vagrant/5.png">

<img src="https://raw.githubusercontent.com/hyuunnn/hyuunnn.github.io/master/assets/images/vagrant/7.png">

한 가지 주의할 점은 Vagrant에 의해 가상 머신이 제어되고 있어서 Vagrant 명령어로 On/Off를 해야 합니다. (<a href="https://youtu.be/Xfc5zZU2eh0?t=435">설명 영상</a>)

`vagrant up`: 해당 경로에 설치된 가상 머신을 실행합니다. (없을 경우 위 사진처럼 가상 머신 환경을 세팅해 줍니다.)

`vagrant halt`: 해당 경로에서 실행된 가상 머신을 종료합니다.

<img src="https://raw.githubusercontent.com/hyuunnn/hyuunnn.github.io/master/assets/images/vagrant/6.png">

`vagrant destroy -f`: 해당 경로에서 생성된 가상 머신을 강제 삭제합니다.

<img src="https://raw.githubusercontent.com/hyuunnn/hyuunnn.github.io/master/assets/images/vagrant/3.png">

`vagrant status`: 현재 가상머신의 상태를 확인할 수 있습니다.

<img src="https://raw.githubusercontent.com/hyuunnn/hyuunnn.github.io/master/assets/images/vagrant/4.png">

Vagrant 사용 중 문제가 발생했다면 - <a href="https://youtu.be/AOupgMg67OQ">vagrant up 실행시 발생하는 에러와 해결책</a> 참고

Vagrant의 다른 명령어들을 알고 싶다면 <a href="https://developer.hashicorp.com/vagrant/docs/cli">docs</a> 참고

### 그 외에 잡다한 링크 모음

<a href="https://youtu.be/_BnSCtlQ0xA">livectf - vagrant</a>

<a href="https://www.yes24.com/Product/Goods/102099414">컨테이너 인프라 환경 구축을 위한 쿠버네티스/도커</a> - <a href="https://github.com/sysnet4admin/_Book_k8sInfra">_Book_k8sInfra</a>, <a href="https://youtu.be/hJO1nxsB5uY?t=525">가상 환경 구성의 장점</a>

<a href="https://www.inflearn.com/course/virtualization-%EA%B0%9C%EB%B0%9C-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%B6%95-%EA%B0%80%EC%9D%B4%EB%93%9C">멀티OS 사용을 위한 가상화 환경 구축 가이드 (Docker + Kubernetes)</a>

<a href="https://github.com/rgl/k3s-vagrant">k3s-vagrant</a>, <a href="https://github.com/k3s-io/vagrant-k3s">vagrant-k3s</a>

<a href="https://developer.hashicorp.com/vagrant/tutorials/getting-started">hashicorp tutorial</a>, <a href="https://www.vagrantup.com/">vagrantup</a>

<a href="https://github.com/hashicorp/vagrant-vmware-desktop">vagrant-vmware-desktop</a>

<a href="https://www.baeldung.com/ops/vagrant-guide">baeldung tutorial</a>

<a href="https://www.44bits.io/ko/post/vagrant-tutorial">44bits tutorial</a>

<a href="https://github.com/iJackUA/awesome-vagrant">awesome-vagrant</a>

<a href="https://github.com/rootsongjc/kubernetes-vagrant-centos-cluster">kubernetes-vagrant-centos-cluster</a>

<a href="https://github.com/geerlingguy/ansible-vagrant-examples">ansible-vagrant-examples</a>

<a href="https://github.com/oracle/vagrant-projects">vagrant-projects - oracle</a>

<a href="https://github.com/R3dy/capsulecorp-pentest">capsulecorp-pentest</a>

<a href="https://github.com/Varying-Vagrant-Vagrants/VVV">VVV</a>

<a href="https://github.com/chef/bento">bento</a>

<a href="https://github.com/vagrant-libvirt/vagrant-libvirt">vagrant-libvirt</a>

<a href="https://github.com/clong/DetectionLab">DetectionLab</a>

<a href="https://github.com/Artemmkin/infrastructure-as-code-tutorial">infrastructure-as-code-tutorial</a>

<a href="https://github.com/rurumimic/how-to-vagrant">how-to-vagrant</a>

<a href="https://github.com/leucos/ansible-tuto">ansible-tuto</a>

<a href="https://github.com/ChristianLempa/boilerplates">boilerplates</a>

<a href="https://github.com/cyberdefenders/DetectionLabELK">DetectionLabELK</a>

<a href="https://github.com/Marshall-Hallenbeck/red_team_attack_lab">red_team_attack_lab</a>

<a href="https://github.com/thomvaill/tads-boilerplate">tads-boilerplate</a>

<a href="https://youngmind.tistory.com/entry/Vagrant-%EC%84%A4%EC%B9%98%EC%99%80-%EA%B5%AC%EC%84%B1">Vagrant-설치와-구성</a>

<a href="https://judo0179.tistory.com/120">나만 알고싶은 Vagrant 사용법</a>

<a href="https://developer-ankiwoong.tistory.com/1835">VMware <-> Vagrant 설치 + 사용</a>

<a href="https://youtu.be/Ip6IHAcII2Q">[Oracle Code Seoul 2017] Vagrant, Terraform, Ansible을 활용한 클라우드 인프라 관리법</a>

<a href="https://youtu.be/AOupgMg67OQ">vagrant up 실행시 발생하는 에러와 해결책</a>

<a href="https://youtu.be/Xfc5zZU2eh0">vagrant로 빠르게 테스트용 VM 생성</a>

<a href="https://youtu.be/6Ksyej9VlSM">How to Build a Multi-Context Lab for Kubernetes</a>

<a href="https://youtu.be/P499YqBUYhw">Deploying Cisco NXOSv with Vagrant</a>

<a href="https://youtu.be/yUuPBlobyRQ">Building Vagrant plugins</a>

<a href="https://youtu.be/r1NY08qKF_c">Getting Started with Minikube in Vagrant</a>

<a href="https://www.amazon.com/Pro-Vagrant-Wlodzimierz-Gajda/dp/1484200748">Pro Vagrant</a>

<a href="https://www.amazon.com/Vagrant-Cookbook-Erika-Heidi/dp/1326020153">Vagrant Cookbook</a>

<a href="https://www.amazon.com/Hands-DevOps-Linux-Pipelines-Kubernetes/dp/9389423481">Hands-on DevOps with Linux</a>

<a href="https://www.amazon.com/Hands-DevOps-Vagrant-end-end/dp/1789138051">Hands-On DevOps with Vagrant</a>

<a href="https://www.amazon.com/Vagrant-Running-Virtualized-Development-Environments/dp/1449335837">Vagrant: Up and Running</a>

<a href="https://www.amazon.com/Vagrant-Virtual-Development-Environment-Cookbook/dp/1784393746">Vagrant Virtual Development Environment Cookbook</a>

<a href="https://www.amazon.com/Creating-Development-Environments-Vagrant-Second/dp/1784397024">Creating Development Environments with Vagrant</a>
